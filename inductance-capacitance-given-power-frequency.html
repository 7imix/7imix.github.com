<!DOCTYPE html>
<html>
    <head>
        <title>DC Resonant Charging Circuit Calculator</title>
        <style type="text/css">

body {
    font-family: Helvetica, Verdana, Arial, sans-serif;
    padding: 1em;
}

#background {
    position: absolute;
    top: 0px;
    right: 0px;
    text-align: right;
}

.chart {
    width: 720px;
    height: 512px;
}

h1 { margin-top: 0px; }

span.out {
    color: blue;
}
        </style>
        <script src="raphael-min.js" type="text/javascript"></script>
        <script src="g.raphael-min.js" type="text/javascript"></script>
        <script src="g.line-min.js" type="text/javascript"></script>

        <script type="text/javascript">
<!--
window.onload = function() {
    var freq = 400,
        xpoints = new Array(20),
        ypoints = [new Array(20), new Array(20)];
    for (var i = 0; i < 20; i++) {
        xpoints[i] = freq;
        freq += 100;
        document.getElementById('freq').value = freq;
		var vals = set_frequency();
		ypoints[0][i] = vals[0];
		ypoints[1][i] = vals[1];
    }
    var cap = Raphael("capacitance_chart"),
		ind = Raphael("inductance_chart"),
        txtattr = { font: "12px sans-serif" };

        
    var lines = cap.linechart(50, 10, 640, 480, xpoints, ypoints[0], { nostroke: false, symbol: "circle", axis: "0 0 1 1"}).hoverColumn(function () {
        this.tags = cap.set();
        
        for (var i = 0, ii = this.y.length; i < ii; i++) {
            this.tags.push(r.tag(this.x, this.y[i], this.values[i] + ' F', 0, 10).insertBefore(this).attr([{ fill: "#fff" }, { fill: this.symbols[i].attr("fill") }]));
        }
    }, function () {
        this.tags && this.tags.remove();
    });

    lines.symbols.attr({ r: 6 });

    var lines2 = ind.linechart(50, 10, 640, 480, xpoints, ypoints[1], { nostroke: false, symbol: "circle", axis: "0 0 1 1"}).hoverColumn(function () {
        this.tags = ind.set();
        
        for (var i = 0, ii = this.y.length; i < ii; i++) {
            this.tags.push(r.tag(this.x, this.y[i], this.values[i] + ' H', 0, 10).insertBefore(this).attr([{ fill: "#fff" }, { fill: this.symbols[i].attr("fill") }]));
        }
    }, function () {
        this.tags && this.tags.remove();
    });

    lines2.symbols.attr({ r: 6 });
}

function out(id, val) {
    document.getElementById(id).innerHTML = val;
}

function out_units(id, val, unit) {
	var descriptor = "",
		place_count = 0,
		descriptors = {
		    "0":"",
			"-1":"milli",
			"-2":"micro",
			"-3":"nano",
			"-4":"pico",
			"1":"kilo",
			"2":"mega",
			"3":"giga",
			"4":"tera"
		};

	if (val > 1) {
		while (val > 1000) {
			place_count++;
			val = val / 1000;
		}
	} else {
		while (val < 1) {
			place_count--;
			val = val * 1000;
	}
	descriptor = descriptors[place_count];
	out(id, val + " " + descriptor + unit);
}

function choose_preset(val) {
    document.getElementById('freq').value = val;
    set_frequency();
}

function update_presets(f) {
    var p = document.getElementById("presets");
    var op = document.createElement("option");
    op.appendChild(document.createTextNode(f));
    p.appendChild(op);
    if (p.childNodes.length > 10) {
        p.removeChild(p.firstChild);
    }
}

function set_frequency() {

    var f = parseFloat(
        document.getElementById('freq').value
    ),
		p = parseFloat(
		document.getElementById('power').value
	),
		V = parseFloat(
		document.getElementById('voltage').value
	);
    update_presets(f);

	out_unit('f', f, "c/sec");
    out_unit('p', p, "watts");
	out_unit('V', V, "volts");

    var c = p / (2 * f * (V*V)),
		l = (2 * (V * V))/((Math.PI * Math.PI) * p * f);

    out_unit('c', c, "farad");
    out_unit('l', l, "henries");

    return [c, l];
}

-->
        </script>
    
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=AM_HTMLorMML" type="text/javascript"></script>


    </head>
    <body>

<h1>DC Resonant Charging Circuit Calculator</h1>

<p>A calculator for calculating a
	
	<a href="http://www.richieburnett.co.uk/dcreschg.html#resonant">DC Resonant Charging Circuit</a>

</p>

<div class="chart" id="capacitance_chart"></div>
<p>X axis, frequency; Y axis, capacitance</p>
<div class="chart" id="inductance_chart"></div>
<p>X axis, frequency; Y axis, inductance</p>

<form onsubmit="set_frequency(); return false">
    <label for="freq">Frequency: </label>
    <input id="freq" type="text" name="freq" value="2000"> c/sec
    <label for="power">Power: </label>
	<input id="power" name="freq" value="70"> watts
	<input id="voltage" name="voltage" value="2000"> volts
    <input type="submit" value="Calculate">
    <select onchange="choose_preset(this.value)">
		<option>2000</option>
        <option>1000</option>
        <option>800</option>
		<option>500</option>
		<option>200</option>
        <optgroup id="presets" label="Recent">
        </optgroup>
    </select>
</form>




<h2>Capacitance and Inductance</h2>
<p>`f =` <span class="out" id="f">?</span></p>

<p>`p =` <span class="out" id="p">?</span></p>

<p>`V =` <span class="out" id="V">?</span></p>

<h3>Capacitance</h3>
<p>`c = p / (2 * f * V^2)`</p>
<p>`c =` <span class="out" id="c">?</span></p>

<h3>Inductance</h3>
<p>`l = (2 * V^2)/(pi^2 * p * f)`</p>
<p>`l =` <span class="out" id="l">?</span></p>

    </body>
</html>
